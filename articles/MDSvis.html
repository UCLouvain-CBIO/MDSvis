<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Visualization of Multi Dimensional Scaling (MDS) objects • MDSvis</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Visualization of Multi Dimensional Scaling (MDS) objects">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MDSvis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/MDSvis.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/MDSvis_Input_From_Distance.html">Preparing `MDSvis` input objects from a distance matrix and sample properties</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/UCLouvain-CBIO/MDSvis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Visualization of Multi Dimensional Scaling (MDS) objects</h1>
                        <h4 data-toc-skip class="author">Andrea
Vicini</h4>
                                    <h4 data-toc-skip class="author">Philippe
Hauchamps</h4>
                        
      
      <small class="dont-index">Source: <a href="https://github.com/UCLouvain-CBIO/MDSvis/blob/main/vignettes/MDSvis.Rmd" class="external-link"><code>vignettes/MDSvis.Rmd</code></a></small>
      <div class="d-none name"><code>MDSvis.Rmd</code></div>
    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>This vignette is the main one describing the functionality
      implemented in the <code>MDSvis</code> package.
      <code>MDSvis</code> conatins a shiny application enabling
      interactive visualization of Multi Dimensional Scaling (MDS)
      objects. This vignette is distributed under a CC BY-SA 4.0
      license.</p>
    </div>
    
<div class="section level2">
<h2 id="installation-and-loading-dependencies">Installation and loading dependencies<a class="anchor" aria-label="anchor" href="#installation-and-loading-dependencies"></a>
</h2>
<p>To install this package, start R and enter (un-commented):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># if (!require("devtools", quietly = TRUE))</span></span>
<span><span class="co">#     install.packages("devtools")</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># devtools::install_github(repo = 'https://github.com/UCLouvain-CBIO/MDSvis')</span></span></code></pre></div>
<p>We now load the packages needed in the current vignette:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lmweber/HDCytoData" class="external-link">HDCytoData</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://uclouvain-cbio.github.io/CytoMDS" class="external-link">CytoMDS</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://uclouvain-cbio.github.io/MDSvis">MDSvis</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>MDSvis</code> package implements visualization of Multi
Dimensional Scaling (MDS) objects representing a low dimensional
projection of sample distances. Such objects can be obtained using
features implemented in the <code>CytoMDS</code> package (<span class="citation">Hauchamps et al. (2025)</span>). For more information
see the <a href="https://www.bioconductor.org/packages/release/bioc/vignettes/CytoMDS/inst/doc/CytoMDS.html" class="external-link"><code>CytoMDS</code>
vignette</a>.</p>
<p>The visualization is done via a Shiny app that allows the user to
interactively customise the plots depending on a series of input
parameters (see the <code><a href="https://uclouvain-cbio.github.io/CytoMDS/reference/ggplotSampleMDS.html" class="external-link">CytoMDS::ggplotSampleMDS()</a></code> function for
more details on the parameters).</p>
<p><strong>IMPORTANT</strong>: the example provided in the current
vignette uses cytometry data. As a result, the distance matrix, which
contains the pairwise sample distances, and serves as input to the MDS
projection, is here calculated from cytometry data samples using the
<code>CytoMDS</code> package. However, the input MDS object can also be
calculated from any distance matrix, where the units of interest are not
necessarily cytometry samples. This is demonstrated in this additional
<a href="MDSvis_Input_From_Distance.html">vignette</a>.</p>
</div>
<div class="section level2">
<h2 id="illustrative-dataset">Illustrative dataset<a class="anchor" aria-label="anchor" href="#illustrative-dataset"></a>
</h2>
<p>We load an illustrative mass cytometry (<em>CyTOF</em>) dataset from
<span class="citation">(Krieg et al. 2018)</span>, accessible from the
Bioconductor <em>HDCytoData</em> data package (<span class="citation">Weber and Soneson (2019)</span>).</p>
<p><em>Krieg_Anti_PD_1</em> was used to characterize immune cell subsets
in peripheral blood from melanoma skin cancer patients treated with
anti-PD-1 immunotherapy.</p>
<p>This study found that the frequency of CD14+CD16-HLA-DRhi monocytes
in baseline samples (taken from patients prior to treatment) was a
strong predictor of survival in response to immunotherapy treatment.</p>
<p>Notably, this dataset contains a strong batch effect, due to sample
acquisition on two different days (<span class="citation">Krieg et al.
(2018)</span>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Krieg_fs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/HDCytoData/man/Krieg_Anti_PD_1_SE.html" class="external-link">Krieg_Anti_PD_1_flowSet</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## see ?HDCytoData and browseVignettes('HDCytoData') for documentation</span></span></code></pre>
<pre><code><span><span class="co">## loading from cache</span></span></code></pre>
<pre><code><span><span class="co">## Warning in updateObjectFromSlots(object, ..., verbose = verbose): dropping</span></span>
<span><span class="co">## slot(s) 'colnames' from object = 'flowSet'</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Krieg_fs</span></span></code></pre></div>
<pre><code><span><span class="co">## A flowSet with 20 experiments.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## column names(49): Pd104Di Pd105Di ... batch_id sample_id</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="computation-of-input-files">Computation of input files<a class="anchor" aria-label="anchor" href="#computation-of-input-files"></a>
</h2>
<p>Next we build a <em>phenodata</em> dataframe with experimental design
information, which are here found in the cytometry data structures.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># update phenoData structure</span></span>
<span></span>
<span><span class="va">chLabels</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/keyword-methods.html" class="external-link">keyword</a></span><span class="op">(</span><span class="va">Krieg_fs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="st">"MARKER_INFO"</span><span class="op">)</span><span class="op">$</span><span class="va">MARKER_INFO</span><span class="op">$</span><span class="va">channel_name</span></span>
<span><span class="va">chMarkers</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/keyword-methods.html" class="external-link">keyword</a></span><span class="op">(</span><span class="va">Krieg_fs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="st">"MARKER_INFO"</span><span class="op">)</span><span class="op">$</span><span class="va">MARKER_INFO</span><span class="op">$</span><span class="va">marker_name</span></span>
<span><span class="va">marker_class</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/keyword-methods.html" class="external-link">keyword</a></span><span class="op">(</span><span class="va">Krieg_fs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="st">"MARKER_INFO"</span><span class="op">)</span><span class="op">$</span><span class="va">MARKER_INFO</span><span class="op">$</span><span class="va">marker_class</span></span>
<span></span>
<span><span class="va">chLabels</span> <span class="op">&lt;-</span> <span class="va">chLabels</span><span class="op">[</span><span class="va">marker_class</span> <span class="op">!=</span> <span class="st">"none"</span><span class="op">]</span></span>
<span><span class="va">chMarkers</span> <span class="op">&lt;-</span> <span class="va">chMarkers</span><span class="op">[</span><span class="va">marker_class</span> <span class="op">!=</span> <span class="st">"none"</span><span class="op">]</span></span>
<span><span class="co"># marker_class all equal to "type", 24 markers are left</span></span>
<span></span>
<span><span class="va">phenoData</span> <span class="op">&lt;-</span> <span class="fu">flowCore</span><span class="fu">::</span><span class="fu">pData</span><span class="op">(</span><span class="va">Krieg_fs</span><span class="op">)</span></span>
<span><span class="va">additionalPhenoData</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/keyword-methods.html" class="external-link">keyword</a></span><span class="op">(</span><span class="va">Krieg_fs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="st">"EXPERIMENT_INFO"</span><span class="op">)</span><span class="op">$</span><span class="va">EXPERIMENT_INFO</span></span>
<span><span class="va">phenoData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">phenoData</span>, <span class="va">additionalPhenoData</span><span class="op">)</span></span>
<span>    </span>
<span><span class="fu">flowCore</span><span class="fu">::</span><span class="fu">pData</span><span class="op">(</span><span class="va">Krieg_fs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">phenoData</span></span></code></pre></div>
<p>Next, we scale-transform the mass cytometry data and calculate the
pairwise distance matrix.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># transform flow set (arcsinh(cofactor = 5))</span></span>
<span><span class="va">trans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/arcsinhTransform.html" class="external-link">arcsinhTransform</a></span><span class="op">(</span></span>
<span>    transformationId<span class="op">=</span><span class="st">"ArcsinhTransform"</span>, </span>
<span>    a <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    b <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span>, </span>
<span>    c <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Applying arcsinh() transformation</span></span>
<span><span class="va">Krieg_fs_trans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/transform.html" class="external-link">transform</a></span><span class="op">(</span></span>
<span>    <span class="va">Krieg_fs</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/transformList-class.html" class="external-link">transformList</a></span><span class="op">(</span><span class="va">chLabels</span>, <span class="va">trans</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculating Sample distances</span></span>
<span><span class="va">pwDist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://uclouvain-cbio.github.io/CytoMDS/reference/pairwiseEMDDist.html" class="external-link">pairwiseEMDDist</a></span><span class="op">(</span></span>
<span>    <span class="va">Krieg_fs_trans</span>,</span>
<span>    channels <span class="op">=</span> <span class="va">chMarkers</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>From the distance matrix, we can now calculate the MDS projection.
This is also done using the <code>CytoMDS</code> package.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mdsObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://uclouvain-cbio.github.io/CytoMDS/reference/computeMetricMDS.html" class="external-link">computeMetricMDS</a></span><span class="op">(</span></span>
<span>    <span class="va">pwDist</span>,</span>
<span>    seed <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">show</span><span class="op">(</span><span class="va">mdsObj</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## MDS object containing MDS projection (using Smacof algorithm)  data:</span></span>
<span><span class="co">## Nb of dimensions:  2 </span></span>
<span><span class="co">## Nb of points:  20 </span></span>
<span><span class="co">## Stress:  0.052363 </span></span>
<span><span class="co">## Pseudo RSquare:  0.984008 </span></span>
<span><span class="co">## Goodness of fit:  0.997258</span></span></code></pre>
<p>Optionally, for the use of biplots as an interpretation tool, sample
specific statistics can be provided by the user. Here we calculate
standard univariate statistics from each variable of the
multidimensional distribution (again using the <code>CytoMDS</code>
package).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Computing sample statistics</span></span>
<span></span>
<span><span class="co"># statFUNs = c("median" = stats::median,</span></span>
<span><span class="co">#              "Q25" = function(x, na.rm) {</span></span>
<span><span class="co">#                  stats::quantile(x, probs = 0.25)</span></span>
<span><span class="co">#              },</span></span>
<span><span class="co">#              "Q75" = function(x, na.rm) {</span></span>
<span><span class="co">#                  stats::quantile(x, probs = 0.75)</span></span>
<span><span class="co">#              },</span></span>
<span><span class="co">#              "standard deviation" = stats::sd)</span></span>
<span><span class="co"># chStats &lt;- channelSummaryStats(BCRXL_fs_trans,</span></span>
<span><span class="co">#                                channels = chLabels, </span></span>
<span><span class="co">#                                statFUNs = statFUNs)</span></span>
<span></span>
<span><span class="va">statFUNs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"median"</span> <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span>,</span>
<span>              <span class="st">"std-dev"</span> <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span>,</span>
<span>              <span class="st">"mean"</span> <span class="op">=</span> <span class="fu">base</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span>,</span>
<span>              <span class="st">"Q25"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">na.rm</span><span class="op">)</span> </span>
<span>                  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">x</span>, probs <span class="op">=</span> <span class="fl">0.25</span>, na.rm <span class="op">=</span> <span class="va">na.rm</span><span class="op">)</span>,</span>
<span>              <span class="st">"Q75"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">na.rm</span><span class="op">)</span> </span>
<span>                  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">x</span>, probs <span class="op">=</span> <span class="fl">0.75</span>, na.rm <span class="op">=</span> <span class="va">na.rm</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chStats</span> <span class="op">&lt;-</span> <span class="fu">CytoMDS</span><span class="fu">::</span><span class="fu"><a href="https://uclouvain-cbio.github.io/CytoMDS/reference/channelSummaryStats.html" class="external-link">channelSummaryStats</a></span><span class="op">(</span></span>
<span>    <span class="va">Krieg_fs_trans</span>,</span>
<span>    channels <span class="op">=</span> <span class="va">chMarkers</span>,</span>
<span>    statFUNs <span class="op">=</span> <span class="va">statFUNs</span><span class="op">)</span></span></code></pre></div>
<p>We save the newly created objects as .rds files.<br>
(Uncomment the corresponding code to do it).<br>
These files can now be selected within the shiny app for
visualization.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#saveRDS(mdsObj, file = "Krieg_mdsObj.rds")</span></span>
<span><span class="co">#saveRDS(phenoData, file = "Krieg_phenoData.rds")</span></span>
<span><span class="co">#saveRDS(chStats, file = "Krieg_chStats.rds")</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualization-of-the-mds-projection">Visualization of the MDS projection<a class="anchor" aria-label="anchor" href="#visualization-of-the-mds-projection"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MDSvis::run_app()</span></span></code></pre></div>
<p>The <code>MDSvis</code> function <code>run_app</code> launches the
interactive Shiny app and the three tabs window in the figure below gets
opened. In the ‘Input files’ tab the objects can be loaded for
visualization. The plots are then shown in the ‘View’ tab while the
‘General settings’ contains more technical plot settings controls. All
the input files are expected to have .rds extension and at least a file
containing the MDS object has to be loaded. Optionally a phenodata file
containing a phenodata dataframe and/or a file containing a list of
statistics for biplot visualization can be loaded.</p>
<p><img src="images/InputFiles.png"> We can select the previously
created files and proceed with the visualization. Note that when a
phenodata file is selected a new control appears allowing to select only
a subset of variables (by default all are selected). These phenodata
selected variables will be the only ones available in the drop-down list
controls in the ‘View’ tab.</p>
<p><img src="images/InputFiles2.png"> We can now open the ‘View’ tab
to see the plot of the projection results. The controls on the side
allow to choose the projection axes; colour, label, define facet or
shape the points according to phenodata variables; add biplot; show a
<code>plotly</code> plot for interactive plot exploration or flip
axes.</p>
<p><img src="images/View.png"> For example we can colour the points
according to group_id, label the points according to sample_id, and use
shapes according to batch_id, as shown in the figure below.</p>
<p><img src="images/View2.png"> We can also defne facets according to
the two batches, as in the figure below:</p>
<p><img src="images/View3.png"></p>
<p>We can also add a biplot created based on sample statistics by
clicking on the biplot checkbox. The idea is to calculate the
correlation of the sample statistics w.r.t. the axes of projection, so
that these correlations can be represented on a correlation circle
overlaid on the projection plot.</p>
<p>The desired statistic can be selected from the drop down menu and it
is possible to show only the arrows that respect a selected length
threshold.<br>
In the example below, the chosen statistic is the median while the arrow
length threshold is 0.8.</p>
<p><img src="images/ViewBiplot.png"></p>
<p>When some data are too large to be displayed as labels, one possible
solution is to display an interactive <code>plotly</code> plot below the
regular one by selecting the corresponding checkbox.<br>
We can add new <code>plotly</code> tooltips and highlight the
corresponding information for each point by hovering over them.</p>
<p><img src="images/ViewPlotly.png"></p>
<p>Finally, the obtained plots can be exported as a pdf file. The user
can defined the corresponding plot title, pdf file name and plot size
(with and height) to be used.</p>
<p><img src="images/PDFExport.png"></p>
</div>
<div class="section level2">
<h2 id="general-settings">General settings<a class="anchor" aria-label="anchor" href="#general-settings"></a>
</h2>
<p>For completeness we show below the ‘General settings’ tab which
contains some general controls regarding e.g. points features, the
corresponding labels and biplot arrows. For more details see the
<code><a href="https://uclouvain-cbio.github.io/CytoMDS/reference/ggplotSampleMDS.html" class="external-link">CytoMDS::ggplotSampleMDS()</a></code> function parameters.</p>
<p><img src="images/GeneralSettings.png"></p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<pre><code><span><span class="co">## R version 4.5.0 (2025-04-11)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">## Running under: Ubuntu 24.04.2 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">## [8] base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] MDSvis_0.1.6                CytoMDS_1.5.0              </span></span>
<span><span class="co">##  [3] HDCytoData_1.29.0           flowCore_2.21.0            </span></span>
<span><span class="co">##  [5] SummarizedExperiment_1.39.0 Biobase_2.69.0             </span></span>
<span><span class="co">##  [7] GenomicRanges_1.61.0        GenomeInfoDb_1.45.3        </span></span>
<span><span class="co">##  [9] IRanges_2.43.0              S4Vectors_0.47.0           </span></span>
<span><span class="co">## [11] MatrixGenerics_1.21.0       matrixStats_1.5.0          </span></span>
<span><span class="co">## [13] ExperimentHub_2.99.0        AnnotationHub_3.99.1       </span></span>
<span><span class="co">## [15] BiocFileCache_2.99.0        dbplyr_2.5.0               </span></span>
<span><span class="co">## [17] BiocGenerics_0.55.0         generics_0.1.4             </span></span>
<span><span class="co">## [19] BiocStyle_2.37.0           </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] splines_4.5.0        later_1.4.2          filelock_1.0.3      </span></span>
<span><span class="co">##   [4] tibble_3.2.1         graph_1.87.0         XML_3.99-0.18       </span></span>
<span><span class="co">##   [7] rpart_4.1.24         lifecycle_1.0.4      httr2_1.1.2         </span></span>
<span><span class="co">##  [10] Rdpack_2.6.4         doParallel_1.0.17    flowWorkspace_4.21.0</span></span>
<span><span class="co">##  [13] lattice_0.22-7       MASS_7.3-65          backports_1.5.0     </span></span>
<span><span class="co">##  [16] magrittr_2.0.3       Hmisc_5.2-3          plotly_4.10.4       </span></span>
<span><span class="co">##  [19] sass_0.4.10          rmarkdown_2.29       jquerylib_0.1.4     </span></span>
<span><span class="co">##  [22] yaml_2.3.10          plotrix_3.8-4        httpuv_1.6.16       </span></span>
<span><span class="co">##  [25] DBI_1.2.3            minqa_1.2.8          RColorBrewer_1.1-3  </span></span>
<span><span class="co">##  [28] abind_1.4-8          ggcyto_1.37.0        purrr_1.0.4         </span></span>
<span><span class="co">##  [31] nnet_7.3-20          pracma_2.4.4         rappdirs_0.3.3      </span></span>
<span><span class="co">##  [34] transport_0.15-4     gdata_3.0.1          ellipse_0.5.0       </span></span>
<span><span class="co">##  [37] pkgdown_2.1.2.9000   codetools_0.2-20     DelayedArray_0.35.1 </span></span>
<span><span class="co">##  [40] tidyselect_1.2.1     shape_1.4.6.1        UCSC.utils_1.5.0    </span></span>
<span><span class="co">##  [43] farver_2.1.2         lme4_1.1-37          base64enc_0.1-3     </span></span>
<span><span class="co">##  [46] jsonlite_2.0.0       e1071_1.7-16         mitml_0.4-5         </span></span>
<span><span class="co">##  [49] Formula_1.2-5        survival_3.8-3       iterators_1.0.14    </span></span>
<span><span class="co">##  [52] systemfonts_1.2.3    foreach_1.5.2        tools_4.5.0         </span></span>
<span><span class="co">##  [55] ragg_1.4.0           Rcpp_1.0.14          glue_1.8.0          </span></span>
<span><span class="co">##  [58] gridExtra_2.3        pan_1.9              SparseArray_1.9.0   </span></span>
<span><span class="co">##  [61] xfun_0.52            dplyr_1.1.4          withr_3.0.2         </span></span>
<span><span class="co">##  [64] BiocManager_1.30.25  fastmap_1.2.0        boot_1.3-31         </span></span>
<span><span class="co">##  [67] shinyjs_2.1.0        digest_0.6.37        R6_2.6.1            </span></span>
<span><span class="co">##  [70] mime_0.13            mice_3.17.0          textshaping_1.0.1   </span></span>
<span><span class="co">##  [73] colorspace_2.1-1     gtools_3.9.5         RSQLite_2.3.11      </span></span>
<span><span class="co">##  [76] weights_1.0.4        tidyr_1.3.1          hexbin_1.28.5       </span></span>
<span><span class="co">##  [79] data.table_1.17.2    class_7.3-23         httr_1.4.7          </span></span>
<span><span class="co">##  [82] htmlwidgets_1.6.4    S4Arrays_1.9.0       pkgconfig_2.0.3     </span></span>
<span><span class="co">##  [85] gtable_0.3.6         blob_1.2.4           RProtoBufLib_2.21.0 </span></span>
<span><span class="co">##  [88] XVector_0.49.0       htmltools_0.5.8.1    bookdown_0.43       </span></span>
<span><span class="co">##  [91] scales_1.4.0         png_0.1-8            wordcloud_2.6       </span></span>
<span><span class="co">##  [94] reformulas_0.4.1     knitr_1.50           rstudioapi_0.17.1   </span></span>
<span><span class="co">##  [97] checkmate_2.3.2      nlme_3.1-168         curl_6.2.2          </span></span>
<span><span class="co">## [100] nloptr_2.2.1         proxy_0.4-27         cachem_1.1.0        </span></span>
<span><span class="co">## [103] stringr_1.5.1        BiocVersion_3.22.0   parallel_4.5.0      </span></span>
<span><span class="co">## [106] foreign_0.8-90       AnnotationDbi_1.71.0 desc_1.4.3          </span></span>
<span><span class="co">## [109] pillar_1.10.2        grid_4.5.0           vctrs_0.6.5         </span></span>
<span><span class="co">## [112] promises_1.3.2       cytolib_2.21.0       jomo_2.7-6          </span></span>
<span><span class="co">## [115] xtable_1.8-4         cluster_2.1.8.1      htmlTable_2.4.3     </span></span>
<span><span class="co">## [118] Rgraphviz_2.53.0     evaluate_1.0.3       cli_3.6.5           </span></span>
<span><span class="co">## [121] compiler_4.5.0       rlang_1.1.6          crayon_1.5.3        </span></span>
<span><span class="co">## [124] smacof_2.1-7         ncdfFlow_2.55.0      plyr_1.8.9          </span></span>
<span><span class="co">## [127] fs_1.6.6             stringi_1.8.7        viridisLite_0.4.2   </span></span>
<span><span class="co">## [130] BiocParallel_1.43.0  nnls_1.6             Biostrings_2.77.0   </span></span>
<span><span class="co">## [133] lazyeval_0.2.2       glmnet_4.1-8         Matrix_1.7-3        </span></span>
<span><span class="co">## [136] bit64_4.6.0-1        CytoPipeline_1.9.0   ggplot2_3.5.2       </span></span>
<span><span class="co">## [139] KEGGREST_1.49.0      shiny_1.10.0         rbibutils_2.3       </span></span>
<span><span class="co">## [142] broom_1.0.8          memoise_2.0.1        bslib_0.9.0         </span></span>
<span><span class="co">## [145] bit_4.6.0            polynom_1.4-1</span></span></code></pre>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Hauchamps2025-zm" class="csl-entry">
Hauchamps, Philippe, Simon Delandre, Stéphane T. Temmerman, Dan Lin, and
Laurent Gatto. 2025. <span>“Visual Quality Control with CytoMDS, a
Bioconductor Package for Low Dimensional Representation of Cytometry
Sample Distances.”</span> <em>Cytometry Part A</em> 107 (3): 177–86.
https://doi.org/<a href="https://doi.org/10.1002/cyto.a.24921" class="external-link">https://doi.org/10.1002/cyto.a.24921</a>.
</div>
<div id="ref-Krieg2018-zs" class="csl-entry">
Krieg, Carsten, Malgorzata Nowicka, Silvia Guglietta, Sabrina Schindler,
Felix J Hartmann, Lukas M Weber, Reinhard Dummer, Mark D Robinson,
Mitchell P Levesque, and Burkhard Becher. 2018. <span>“High-Dimensional
Single-Cell Analysis Predicts Response to <span class="nocase">anti-PD-1</span> Immunotherapy.”</span> <em>Nat.
Med.</em> 24 (2): 144–53.
</div>
<div id="ref-Weber2019-qp" class="csl-entry">
Weber, Lukas M, and Charlotte Soneson. 2019.
<span>“<span>HDCytoData</span>: Collection of High-Dimensional Cytometry
Benchmark Datasets in Bioconductor Object Formats.”</span>
<em>F1000Res.</em> 8 (August): 1459.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrea Vicini, Philippe Hauchamps, Laurent Gatto.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
